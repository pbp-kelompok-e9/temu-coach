{% extends "base_auth.html" %}
{% load static %}

{% block title %}Register - TemuCoach{% endblock %}

{% block content_style %}
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'auth_core/register.css' %}">
{% endblock %}

{% block content %}
<section class="auth-full">
  <div class="auth-caption">
    <h1 class="quote-title">
      <span class="line">Some People Want It to Happen,</span>
      <span class="line">Others Make It Happen</span>
    </h1>
    <p>
      <span>already have an account?</span><br>
      <span>you can <a href="{% url 'auth_core:auth_login' %}">Login here!</a></span>
    </p>
  </div>

  <div class="auth-form">
    <div class="auth-brand">
      <span class="auth-brand__title">Register</span>
      <img src="{% static 'images/logo.png' %}" alt="TemuCoach" class="auth-brand__logo">
      <span class="auth-brand__name">TemuCoach</span>
    </div>

    {% if messages %}
      <div class="messages">
        {% for message in messages %}
          <p class="message {{ message.tags }}">{{ message }}</p>
        {% endfor %}
      </div>
    {% endif %}

    <form method="post" action="{% url 'auth_core:auth_register' %}">
      {% csrf_token %}

      <!-- First Name -->
      <div class="field">
        <i class="fa-regular fa-user"></i>
        <input id="first-name" type="text" name="first_name" placeholder="First name" required>
      </div>

      <!-- Last Name -->
      <div class="field">
        <i class="fa-regular fa-user"></i>
        <input id="last-name" type="text" name="last_name" placeholder="Last name" required>
      </div>

      <!-- Username + tombol clear -->
      <div class="field">
        <i class="fa-solid fa-user"></i>
        <input id="register-username" type="text" name="username" placeholder="Username" required>
        <button type="button" class="field__action js-clear-input" aria-label="Clear username" hidden>
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>

      <!-- Email -->
      <div class="field">
        <i class="fa-regular fa-envelope"></i>
        <input id="register-email" type="email" name="email" placeholder="Email" required>
      </div>

      <!-- Password -->
      <div class="field field--password">
        <i class="fa-solid fa-lock"></i>
        <input id="register-password" type="password" name="password" placeholder="Password" required>
        <button type="button" class="field__action js-toggle-pass" aria-pressed="false" aria-label="Show password">
          <i class="fa-regular fa-eye"></i>
        </button>
      </div>

      <!-- Confirm Password -->
      <div class="field field--password">
        <i class="fa-solid fa-lock"></i>
        <input id="confirm-password" type="password" name="confirm_password" placeholder="Confirm Password" required>
        <button type="button" class="field__action js-toggle-pass2" aria-pressed="false" aria-label="Show password">
          <i class="fa-regular fa-eye"></i>
        </button>
      </div>

      <div class="field__row-right"></div>

      <button type="submit" class="btn-primary">Register</button>

      <div class="auth-card__or">
        <span>Or sign up with</span>
        <div class="socials">
          <button type="button" class="social-btn">
            <img src="{% static 'auth_core/google-logo.png' %}" alt="Google" />
            Google
          </button>
          <button type="button" class="social-btn">
            <img src="{% static 'auth_core/facebook-logo.png' %}" alt="Facebook" />
            Facebook
          </button>
        </div>
      </div>
    </form>
  </div>
</section>
{% endblock %}

{% block content_script %}
<script>
(function(){
  // Tombol clear input username
  const usr = document.getElementById('register-username');
  const clrBtn = document.querySelector('.js-clear-input');
  function updateClear(){
    clrBtn.hidden = !(usr.value && usr.value.length > 0);
  }
  usr.addEventListener('input', updateClear);
  usr.addEventListener('focus', updateClear);
  usr.addEventListener('blur', updateClear);
  updateClear();

  clrBtn.addEventListener('click', function(){
    usr.value = '';
    usr.focus();
    updateClear();
  });

  // Tombol show/hide password
  const pass1 = document.getElementById('register-password');
  const pass2 = document.getElementById('confirm-password');
  const tog1 = document.querySelector('.js-toggle-pass');
  const tog2 = document.querySelector('.js-toggle-pass2');

  function togglePassword(input, button){
    const isHidden = input.type === 'password';
    input.type = isHidden ? 'text' : 'password';
    button.setAttribute('aria-pressed', String(isHidden));
    const icon = button.querySelector('i');
    if (icon){
      icon.classList.toggle('fa-eye', !isHidden);
      icon.classList.toggle('fa-eye-slash', isHidden);
    }
    input.focus();
  }

  tog1.addEventListener('click', () => togglePassword(pass1, tog1));
  tog2.addEventListener('click', () => togglePassword(pass2, tog2));
})();
</script>
{% endblock %}

