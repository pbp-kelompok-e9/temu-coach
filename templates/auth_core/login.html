{% extends "base_auth.html" %}
{% load static %}

{% block title %}Login - TemuCoach{% endblock %}

{% block content_style %}
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'auth_core/login.css' %}">
{% endblock %}

{% block content %}
<section class="auth-full">
  <div class="auth-caption">
    <h1 class="quote-title">
      <span class="line">Some People Want It to Happen,</span>
      <span class="line">Others Make It Happen</span>
    </h1>
    <p>
      <span>if you donâ€™t have an account</span><br>
      <span>you can <a href="{% url 'auth_core:auth_register' %}">Register here!</a></span>
    </p>
  </div>

  {# wrapper posisi saja; tampilannya transparan via CSS #}
  <div class="auth-form">
    <div class="auth-brand">
      <span class="auth-brand__title">Login</span>
      <img src="{% static 'images/logo.png' %}" alt="TemuCoach" class="auth-brand__logo">
      <span class="auth-brand__name">TemuCoach</span>
    </div>
    <form method="post" action="{% url 'auth_core:auth_login' %}"></form>
    
    {% if messages %}
      <div class="messages">
        {% for message in messages %}
          <p class="message {{ message.tags }}">{{ message }}</p>
        {% endfor %}
      </div>
    {% endif %}

    <form method="post" action="{% url 'auth_core:auth_login' %}">
      {% csrf_token %}
      <input type="hidden" name="next" value="{{ request.GET.next }}">

      <!-- Username + tombol clear -->
      <div class="field">
        <i class="fa-regular fa-user"></i>
        <input id="login-username" type="text" name="username" placeholder="Username" required>
        <button type="button" class="field__action js-clear-input" aria-label="Clear username" hidden>
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>

      <!-- Password + tombol show/hide -->
      <div class="field field--password">
        <i class="fa-solid fa-lock"></i>
        <input id="login-password" type="password" name="password" placeholder="Password" required>
        <button type="button" class="field__action js-toggle-pass" aria-pressed="false" aria-label="Show password">
          <i class="fa-regular fa-eye"></i>
        </button>
      </div>

      <!-- Reset Password di luar field -->
      <div class="field__row-right">
        <a href="{% url 'auth_core:auth_forgot_password' %}" class="reset-link">Reset Password</a>
      </div>

      <button type="submit" class="btn-primary">Login</button>

      <div class="auth-card__or">
        <span>Or continue with</span>
        <div class="socials">
          <button type="button" class="social-btn">
            <img src="{% static 'auth_core/google-logo.png' %}" alt="Google" />
            Google
          </button>
          <button type="button" class="social-btn">
            <img src="{% static 'auth_core/facebook-logo.png' %}" alt="Facebook" />
            Facebook
          </button>
        </div>
      </div>
    </form>
  </div>
</section>
{% endblock %}

{% block content_script %}
<script>
(function(){
  const usr = document.getElementById('login-username');
  const clrBtn = document.querySelector('.js-clear-input');
  const pwd = document.getElementById('login-password');
  const togBtn = document.querySelector('.js-toggle-pass');

  function updateClear(){
    clrBtn.hidden = !(usr.value && usr.value.length > 0);
  }
  usr.addEventListener('input', updateClear);
  usr.addEventListener('focus', updateClear);
  usr.addEventListener('blur', updateClear);
  updateClear();

  clrBtn.addEventListener('click', function(){
    usr.value = '';
    usr.focus();
    updateClear();
  });

  togBtn.addEventListener('click', function(){
    const isHidden = pwd.type === 'password';
    pwd.type = isHidden ? 'text' : 'password';
    this.setAttribute('aria-pressed', String(isHidden));
    const icon = this.querySelector('i');
    if (icon){
      icon.classList.toggle('fa-eye', !isHidden);
      icon.classList.toggle('fa-eye-slash', isHidden);
    }
    pwd.focus();
  });
})();
</script>
{% endblock %}

